## **Основы шаблонизации в Django**

### Динамический контент в HTML страницах

Веб-страницы состоят из HTML-кода. Однако, когда вы работаете с динамическим контентом, необходимо как-то передавать данные из вашего веб-приложения в эти HTML-страницы. И здесь на сцену выходят шаблоны.

**Шаблоны — это ваш инструмент для создания динамичных страниц.** Они выполняют несколько ключевых задач, которые делают жизнь разработчика легче.

Представьте, у вас есть веб-сайт с каталогом книг. Вы хотите, чтобы каждая книга отображалась на вашей веб-странице в определенном формате, содержащем название и краткое описание. Без шаблонов, вы были бы вынуждены вручную вписывать эти данные в HTML-код для каждой книги. Это было бы утомительно и неэффективно.

С помощью шаблонов вы можете создать универсальный шаблон, который отвечает за отображение книги. Каждый раз, когда вы хотите отобразить новую книгу, вы просто передаете данные в этот шаблон, и он генерирует HTML для вас.

Почему это важно?

- **Разделение логики:** Шаблоны позволяют вам разделить логику вашего веб-приложения (как обрабатывать данные) от того, как эти данные отображаются на веб-странице. Это делает ваш код более чистым и поддерживаемым.
- **Гибкость:** С помощью шаблонов вы можете легко изменять внешний вид ваших страниц, не затрагивая бизнес-логику. Если вам нужно обновить дизайн, вы изменяете шаблон, не трогая ваш Python-код.

**Пример:**

```html
<!-- book_template.html -->

<div class="book">
    <h2>{{ book_title }}</h2>
    <p>{{ book_description }}</p>
</div>

```

В этом примере шаблон `book_template.html` использует фиксированный формат, но значения для каждой книги подставляются динамически при каждом запросе. Это и есть суть роли шаблонов в веб-разработке с использованием Django. Здесь появились записи, которые заключены в фигурные скобки `{{ ... }}`, они не относятся к HTML, а являются частью синтаксиса шаблонов. 

## Синтаксис шаблонов Django

**1. Переменные: Передают динамические данные**

Ваши переменные — это данные, которые вы передаете из вашего Python-кода в HTML-шаблон. Представьте, у вас есть словарь `book` с данными о книге, и вы хотите отобразить её заголовок. Вот как вы это делаете:

```python
book = {
    'title': 'Название книги'
}
```

```html
<!-- book_template.html -->
<h1>{{ book.title }}</h1>
```

Здесь `book.title` — это переменная, которая отобразит заголовок вашей книги. Вы пишете имя переменной в двойных фигурных скобках, и Django превращает его в реальные данные.

Шаблоны позволяют обращаться по ключам, атрибутам и индексам, используя точечную нотацию

- `{{ my_dict.key }}`, где `my_dict` — python словарь, `key` — ключ этого словаря;
- `{{ my_object.attribute }}`, где `my_object` — python объект, `attribute` — атрибут этого объекта;

Нужна вставка про атрибут и объект. 

**2. Теги: Позволяют вам внедрять логику в ваш HTML.**

Теги — позволяют выполнять действия в шаблоне. Например, если вы хотите создать цикл для отображения списка книг, вы используете тег `for`:

```html
<ul>
    {% for book in book_list %}
        <li>{{ book.title }}</li>
    {% endfor %}
</ul>

```

В этом примере мы используем тег `{% for ... %}`, чтобы перебирать все книги из списка `book_list` и отображать их заголовки в списках.

**3. Фильтры: Делают ваши данные более красивыми.**

Фильтры — удобны для форматирования данных. Предположим, у вас есть длинное описание книши, и вы хотите отобразить ее в кратком формате:

```html
<p>{{ book.description|truncatewords:10 }}</p>
```

Здесь `truncatewords:10` — это фильтр, который сокращает текст до указанного количества слов, в данном случае до 10. 

Предположим, что оригинальное описание книги выглядело так:

```
Роман о приключениях в далеком королевстве, полном загадок и опасностей, где юный герой сталкивается с темным прошлым и неожиданным будущим.
```

И после применения фильтра `truncatewords:10`, вывод будет следующим:

```
Роман о приключениях в далеком королевстве, полном загадок и опасностей...
```

Таким образом, с использованием фильтра `truncatewords` вы можете сделать описание книги более кратким, отображая только первые 10 слов, а все остальные заменив на многоточие.

## П****ередача данных в шаблоны в Django****

**Шаг 1: Подготовка данных в представлении**

Когда у нас есть какие-то данные, которые мы хотим отобразить в шаблоне, первый шаг - это их подготовка в представлении. Представление в Django - это место, где происходит обработка запроса и подготовка данных для отображения. 

```python
# views.py
from django.shortcuts import render

def view_books(request):
    # Описание одной книги
    book_data = {
        'title': 'Мастер и Маргарита',
        'description': (
            'Роман "Мастер и Маргарита" — это произведение, написанное Михаилом Булгаковым в разные годы '
            'и завершенное в 1940 году, но опубликованное только в 1966 году. '
            'Это произведение считается одним из величайших в русской литературе XX века.'
        ),
    }

    # Передача данных в шаблон в виде контекста
    context = {
        'book': book_data,
        'title': 'Страница книги - Мастер и Маргарита',
    }

    # Использование функции render для создания HTML-кода
    return render(request, 'books/book_detail.html', context=context)
```

Для замены фигурных скобок в шаблонах на реальные данные используется `render` из модуля `shortcuts`. Данные для замены передаются в шаблон с помощью аргумента `context` функции `render`, который является контекстом шаблона. 

Контекст - это словарь, который содержит данные, передаваемые из представления (вашего Python-кода) в шаблон (HTML-код). Этот словарь содержит ключи, которые являются переменными в шаблоне и их значения, которые становятся доступными для использования в шаблоне.

Простой шаблон `book_detail.html` для просмотра HTML страницы о книге может выглядеть следующим образом:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
</head>
<body>

    <h1>{{ book.title }}</h1>

    <p><strong>Описание:</strong></p>
    <p>{{ book.description }}</p>

</body>
</html>

```

В этом шаблоне используются переменные из контекста. `{{ title }}` будет заменено на значение переменной `title`, переданной в контексте. Аналогично, `{{ book.title }}` и `{{ book.description }}` заменятся соответствующими значениями из переменной `book`, переданной в контексте.

Отрендеренный шаблон представляет собой HTML-страницу, сформированную после применения шаблона к определенному контексту данных. В итоге, отрендеренная HTML-страница будет выглядеть так:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Страница книги - Мастер и Маргарита</title>
</head>
<body>

    <h1>Мастер и Маргарита</h1>

    <p><strong>Описание:</strong></p>
    <p>
        Роман "Мастер и Маргарита" — это произведение, написанное Михаилом Булгаковым в разные годы
        и завершенное в 1940 году, но опубликованное только в 1966 году.
        Это произведение считается одним из величайших в русской литературе XX века.
    </p>

</body>
</html>

```

В итоге, синтаксис шаблонов Django — это ваш ключ к созданию динамичных веб-страниц**.** Вы вставляете переменные внутрь HTML, добавляете теги для логики и применяете фильтры для форматирования. Все это помогает строить веб-страницы с легкостью и гибкостью.