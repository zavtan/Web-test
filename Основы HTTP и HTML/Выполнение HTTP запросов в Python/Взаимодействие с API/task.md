# Взаимодействие с API

## **Цель задания:**

Вы научитесь использовать библиотеку **`requests`** в языке программирования Python для взаимодействия с API и выполнения GET запросов с параметрами для передачей информации в URL запроса. 

## Что такое API и зачем оно нужно

API (Application Programming Interface) - это набор методов и инструментов, которые позволяют разным программам взаимодействовать друг с другом. Оно обеспечивает способ общения между разными программами, позволяя им обмениваться данными и функциональностью. API играет ключевую роль в клиент-серверном взаимодействии, где клиентские приложения обращаются к серверу для получения данных или выполнения определенных операций.

### Почему API возвращают JSON данные

JSON (JavaScript Object Notation) - это формат обмена данными, который является популярным стандартом для передачи структурированных данных между клиентом и сервером. Он легко читаем для человека и одновременно удобен для парсинга компьютером. Многие API используют JSON как формат данных для обмена информацией, так как он позволяет структурировать данные, передавать списки, объекты и другие сложные структуры.

Давайте рассмотрим пример работы с реальным API. Предположим, что очень захотелось случайных фактов о животных, и конечно же о котиках. Чтобы их получить достаточно выполнить GET запрос к API:

```python
# Импортируем необходимые библиотеки
import json

import requests

# Указываем URL API, откуда будем получать факты о животных
url = "https://cat-fact.herokuapp.com/facts/random"
response = requests.get(url)

print(f"Тип контента: {response.headers['Content-Type']}")
print(f"Тело ответа: {response.text}")

# Преобразуем JSON-содержимое ответа в структуру данных Python
data = response.json()

# Выводим отформатированные JSON-данные с отступами для лучшей читаемости
# ensure_ascii=False позволяет правильно обрабатывать не-ASCII символы
print(json.dumps(data, indent=4, ensure_ascii=False))
```

Давайте разберем, что происходит в данном коде. Указываем целевой URL - это API, предоставляющее случайные факты о животных. Выполняем GET запрос по указанному URL и получаем ответ от сервера. Выводим тип контента, который указан в "заголовке" ответа. Это говорит о том, какой тип данных находится в теле ответа. Например, в данном случае, это будет `application/json`, что означает, что содержимое ответа в формате JSON. Также выводим тело ответа с помощью `response.text`. Это просто выводит текстовое представление всего ответа.

Здесь наступает важный момент: используем метод `.json()` для преобразования JSON-содержимого ответа в Python-структуру данных. Это позволяет нам работать с ответом, как с словарем или списком в Python. Используем функцию `json.dumps(data, indent=4, ensure_ascii=False)` для красивой печати JSON-данных. `indent=4` делает отступы для лучшей читаемости, а `ensure_ascii=False` позволяет правильно обрабатывать не-ASCII символы, что особенно полезно при работе с символами других языков.

Таким образом, весь этот код позволяет нам выполнить GET запрос к API, получить JSON-данные, распечатать информацию о типе контента и теле ответа, а затем также красиво отформатировать и распечатать содержимое JSON-данных.

## Параметры запроса при передаче данных в GET запросе

Но что делать, если хочется фактов не только о котиках и больше чем один факт? Нужно как-то сообщить об этом серверу. Параметры запроса позволяют передать дополнительную информацию серверу при выполнении GET запроса. Они указываются в URL после символа вопроса `?` и имеют вид `имя=значение`. Параметры могут использоваться для фильтрации данных, сортировки и других операций на стороне сервера. В ответ на запрос с параметрами сервер обычно возвращает только те данные, которые соответствуют заданным параметрам.

```python
import requests

# Указываем URL для запроса
url = "https://cat-fact.herokuapp.com/facts/random"

# Определяем параметры запроса в виде словаря
params = {
    "animal_type": "dog",  # Указываем тип животного (собака)
    "amount": 2,  # Указываем количество фактов (2)
}

# Выполняем GET запрос к API с указанными параметрами
response = requests.get(url, params=params)

# Выводим тип контента, который вернул сервер
print(f"Тип контента: {response.headers['Content-Type']}")

# Извлекаем JSON данные из ответа и парсим их
data = response.json()

# Перебираем факты из JSON данных и выводим на экран
for num, fact in enumerate(data, start=1):
    print(f"Факт {num}: {fact['text']}")

```

Чтобы получить от сервера случайные факты о собаках к количестве 2 штук определяем параметры запроса. Это как инструкции для сервера: мы хотим факты о собаках (`"animal_type": "dog"`) и их количество равное 2 (`"amount": 2`). С использованием метода `requests.get()` мы отправляем GET запрос к указанному URL с параметрами, которые только что определили, указав значение аргумента `params`. 

Используем цикл `for` для перебора фактов в этом списке. `enumerate(data, start=1)` позволяет нам нумеровать факты, начиная с 1. Внутри цикла обращаемся к каждому факту по ключу `'text'` и выводим его текст на экран.