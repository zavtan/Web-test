# HTTP запросы и ответы

## Цель урока

По окончании этого урока вы поймете, как работают HTTP запросы и ответы, научитесь создавать и отправлять HTTP запросы, а также анализировать полученные HTTP ответы.

## Структура HTTP запроса

HTTP запрос состоит из следующих частей:

1. **Стартовая строка (Start Line)**: Эта часть содержит метод запроса, URL ресурса и версию протокола. Пример: `GET /index.html HTTP/1.1`.
2. **Заголовки (Headers)**: Заголовки содержат метаинформацию о запросе. Они могут включать такие данные, как User-Agent (информация о браузере или клиенте), Accept (типы контента, которые клиент готов принять), Content-Type (тип контента, передаваемого в теле запроса) и другие параметры.
3. **Разделитель (Blank Line)**: Пустая строка, отделяющая заголовки от тела запроса.
4. **Тело запроса (Request Body)**: Это часть запроса, которая может содержать данные, отправляемые на сервер. Например, в запросе методом POST или PUT тело может содержать данные формы или JSON.

Вместе эти компоненты формируют полный HTTP запрос, который отправляется от клиента (обычно браузера) на сервер для запроса определенного ресурса или выполнения определенной операции.

Давайте представим, что веб - это ресторан, а браузеры - наши официанты. Когда вы хотите получить меню, вы запрашиваете его у официанта, и говорите официанту: "Дайте мне меню".

В контексте HTTP запроса, это будет выглядеть следующим образом:

```
GET /menu HTTP/1.1 <- **Стартовая строка**
User-Agent: Mozilla/5.0 <- **Заголовки**
Accept: text/html
```

В данном запросе:

- Метод GET указывает на то, что вы хотите получить данные с сервера.
- URL "/menu" указывает на ресурс (меню), который вы запрашиваете.
- Версия протокола HTTP/1.1 говорит о том, какую версию HTTP вы используете.
- Заголовок User-Agent содержит информацию о вашем браузере или клиенте.
- Заголовок Accept указывает, какие типы данных вы готовы принять.

Метод GET позволяет только получать информацию с сервера, поэтому тело запроса в GET методе пустое. 

А вот когда вы захотите сделать заказ, то вы передадите через официанта те блюда, которые собрались заказать. Если вы собираете передать какую-то информацию на сервер, то следует использовать метод POST. В качестве URL будет  использоваться “заказ”, используя метод POST можно дополнительно в запросе указать те блюда, которые вы собрались заказать. 

В контексте HTTP запроса, это будет выглядеть следующим образом:

```
POST /order HTTP/1.1 <- **Стартовая строка**
Host: restaurant.com <- **Заголовки**
User-Agent: Mozilla/5.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 39
<- **Разделитель**
dishes=pasta,pizza,steak&drinks=coke,water <- **Тело запроса**
```

В данном запросе:

- Метод POST указывает на то, что вы хотите передать данные на сервер.
- URL "/order" указывает на ресурс (заказ), который вы хотите сделать.
- Версия протокола HTTP/1.1 говорит о том, какую версию HTTP вы используете.
- Заголовок Host указывает на доменное имя сервера.
- Заголовок User-Agent содержит информацию о вашем браузере или клиенте.
- Заголовок Content-Type указывает на тип данных, которые вы отправляете.
- Заголовок Content-Length указывает на длину тела запроса.
- Тело запроса содержит параметры заказа в формате `dishes=pasta,pizza,steak&drinks=coke,water`.
    
    В этом запросе:
    
    - В параметре `dishes` указываются блюда, которые вы хотите заказать (например, pasta, pizza, steak).
    - В параметре `drinks` указываются напитки, которые вы хотите заказать (например, coke, water).
    
    Обратите внимание, что параметры разделяются амперсандом (&), чтобы сервер мог правильно интерпретировать различные части данных. Таким образом, вы можете передавать информацию о заказе, включая блюда и напитки, используя метод POST.
    

## Структура HTTP ответа

HTTP ответ состоит из следующих частей:

1. **Стартовая строка (Start Line)**: Эта часть содержит версию протокола, код состояния и текстовое описание кода. Например: `HTTP/1.1 200 OK`.
2. **Заголовки (Headers)**: Заголовки содержат метаинформацию о ответе сервера.
3. **Разделитель (Blank Line)**: Пустая строка между заголовками и телом ответа.
4. **Тело ответа (Response Body)**: Это фактическое содержание ответа сервера. Тело может содержать HTML-код, JSON, изображения или другой контент, в зависимости от типа запроса и контента, который был запрошен.

Вместе эти компоненты формируют полный HTTP ответ, который отправляется от сервера обратно клиенту в ответ на HTTP запрос.

Ответ на GET запрос с меню, то он мог выглядеть следующим образом:

```
HTTP/1.1 200 OK <- **Стартовая строка**
Content-Type: text/html <- **Заголовки**
Content-Length: 382
<- **Разделитель**
<!DOCTYPE html> <- **Тело ответа**
<html>
...
</html>

```

В этом примере:

- Стартовая строка **`HTTP/1.1 200 OK`** говорит о том, что ответ успешен (код состояния 200 OK) и используется протокол версии 1.1.
- Заголовок **`Content-Type: text/html`** указывает, что контент представляет собой HTML.
- Заголовок **`Content-Length`** указывает длину контента в байтах.
- После разделителя (пустая строка) следует тело ответа в формате HTML.

Этот ответ может быть интерпретирован браузером и отображен пользователю в виде веб-страницы с информацией о доступных блюдах и напитках.

А в случае с заказом ответ может быть следующим:

```
HTTP/1.1 201 Created <- **Стартовая строка**
Content-Type: application/json <- **Заголовки**
Content-Length: 122
<- **Разделитель**
{ <- **Тело ответа**
    "order_id": "12345"
}

```

В этом примере:

- Стартовая строка `HTTP/1.1 201 Created` указывает, что был успешно создан ресурс (код состояния 201 Created) и используется протокол версии 1.1.
- Заголовок `Content-Type: application/json` указывает, что контент представляет собой JSON.
- Заголовок `Content-Length` указывает длину контента в байтах.
- После разделителя (пустая строка) следует тело ответа в формате JSON, представляющее информацию о заказе. В данном случае, ответ содержит `order_id` - номер заказа.

### Коды состояния HTTP ответа:

Код состояния в ответе - это как обратная связь от сервера. Он говорит нам, успешно ли прошёл наш запрос или произошли какие-то ошибки. Наиболее распространенные коды состояния:

- 200 OK: запрос выполнен успешно.
- 404 Not Found: запрошенный ресурс не найден.
- 500 Internal Server Error: внутренняя ошибка сервера.

Коды состояния представляют собой трехзначные числовые значения, которые указывают на результат выполнения запроса. Они разделены на классы:

- **1xx (Информационные)**: используются для информационных сообщений.
- **2xx (Успешные):** указывают на успешное выполнение запроса клиента.
    - **200 OK**: Запрос был успешно выполнен. Это наиболее распространенный код для успешных запросов.
    - **201 Created**: Ресурс был успешно создан в результате запроса (например, при создании записи).
    - **204 No Content**: Запрос успешно выполнен, но ответ не содержит контента (например, при успешном удалении ресурса).
- 3xx (Перенаправления): показывают, что для выполнения запроса клиенту следует выполнить дополнительные действия.
    - **302 Found**: Ресурс временно перемещен на другой URL. Клиент также должен использовать новый URL, но это может быть временным.
- 4xx (Ошибки клиента): указывают на ошибки в запросе клиента.
    - **400 Bad Request**: Сервер не может понять запрос из-за ошибок в синтаксисе.
    - **401 Unauthorized**: Клиент не авторизован для доступа к ресурсу. Требуется аутентификация.
    - **404 Not Found**: Запрашиваемый ресурс не найден на сервере.
- 5xx (Ошибки сервера): указывают на ошибки на стороне сервера.
    - **500 Internal Server Error**: Внутренняя ошибка сервера, которая не позволяет выполнить запрос.
    - **503 Service Unavailable**: Сервер временно не может обработать запрос из-за перегрузки или обслуживания.

## **Отправка HTTP запроса**

1. Откройте браузер и в адресной строке введите адрес веб-сайта поисковой системы.
2. Откройте инструменты разработчика браузера (нажмите F12 или используйте сочетание клавиш Ctrl+Shift+I).
3. Перейдите на вкладку "Network" (сеть) и обновите страницу (нажмите F5 или Ctrl+R).
4. Выберите первый запрос в списке и изучите его детали: метод запроса, заголовки, параметры.
5. Проанализируйте ответ сервера: код состояния, заголовки ответа, содержимое ответа.
6. Попробуйте сделать GET запрос к поисковой системе, передав в параметрах ваш поисковый запрос.
