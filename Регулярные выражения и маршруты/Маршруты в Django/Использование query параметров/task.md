## **query параметры в запросах**

Давайте поговорим о query параметрах в URL маршрутах Django. Взглянем на это поближе.

У вас есть веб-приложение с каталогом книг. Чтобы пользователь мог найти книгу по названию, вы можете использовать query параметр. Ваш URL маршрута может выглядеть так: `/books/computer-programming/?title=python`. В этом случае, `title` - это query параметр, а `python` - значение, которое указывает на то, что пользователь ищет книги, в названии которых содержится слово "python".

### **Различие между query параметрами и параметрами пути:**

- **Параметры пути:** Это часть URL, которая содержит переменные данные. Например, в URL `/books/computer-programming/`, `computer-programming` - это параметр пути, представляющий название категории. В коде Django это может выглядеть так:
    
    ```python
    # Ваш файл urls.py
    
    from django.urls import path
    from . import views
    
    urlpatterns = [
        path('books/<slug:category_slug>/', views.view_books),  # category_slug - параметр пути
    ]
    
    ```
    
    В этом примере, `category_slug` - это переменная, которую вы можете использовать в функции представления `view_books` для отображения всех книг по компьютерному программированию.
    
- **Query параметры:** Это часть URL после знака вопроса `?`, где вы можете передавать дополнительные данные. Например, в URL `/books/computer-programming/?title=python`, `title` - это query параметр, а `python` - значение этого параметра.
    
    query параметры удобно использовать для фильтрации. Запросом по URL `/books/computer-programming/?title=python` будут выведены не все книги компьютерному программированию, а только те, которые содержат в названии слово python. 
    

Query параметры в отличии от параметров пути можно использовать для более сложных поисковых запросов, например, содержание определённого слова в тексте или фильтрации по минимальной или максимальной цене товара.

## **Обработка query параметров в Django views**

Давайте разберём, как в Django извлекать информацию из query параметров ваших URL-адресов.

Когда пользователь взаимодействует с вашим веб-приложением, он может передавать дополнительные данные через query параметры в URL. Например, при поиске книг `/books/computer-programming/?title=python`

```python
# Ваш файл urls.py

from django.urls import path
from . import views

urlpatterns = [
    path('books/<slug:category_slug>/', views.view_books),  # category_slug - параметр пути
]

```

В данном случае, URL `/books/computer-programming/` может иметь дополнительные параметры, например, `/books/computer-programming/?title=python`.

Теперь, чтобы получить значение query параметра в функции представления, следует использовать объект `request.GET`. Давайте посмотрим, как это делается:

```python
# Ваш файл views.py

def view_books(request, category_slug):
    if request.method == 'GET':
        # фильтруем книги сначала по категории category_slug
        ...

        # Получаем значение query параметра 'title' из объекта request.GET
        search_query = request.GET.get('title', '')

        # Теперь search_query содержит значение, которое ввёл пользователь
        if search_query:
            ...  # Вы можете использовать это значение для выполнения поиска книг с определённым словом в названии
```

Этот код представляет собой представление Django, которое обрабатывает GET-запрос для страницы поиска результатов в книжном магазине. Давайте разберем, что делает каждая часть кода:

1. **Определение функции представления `view_books`:**
    
    Эта функция принимает два аргумента: `request` (объект запроса Django) и `category_slug` (строка, представляющая "слаг" категории, извлеченную из параметра пути). `category_slug` позволяет получить все книги определённой категории. 
    
2. **Проверка метода запроса:**
    
    `if request.method == 'GET':`
    
    Проверяется, что запрос осуществлен методом GET. Таким образом, это представление реагирует только на GET-запросы. 
    
3. **Извлечение параметра запроса 'query':**
    
    `request.GET.get('title', '')` здесь из объекта `request.GET` извлекается значение параметра 'title'. Если 'title' не указан в запросе, будет использована пустая строка, так как query параметры не являются обязательным. 
    
4. Если пользователь указал значение параметра 'title', то будет выполнена дополнительная фильтрация книг из категории.